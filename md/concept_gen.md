## Концепция системы генерации (The concept of the generation system)

## Генератор продаж магазина (Store Sales Generator):

### 0. Вводим понятие "минимальной длительности операции на кассе".
Т.е., какова длительность самой быстрой регистрации продажи на кассе. Тогда "максимальное 
количество чеков" по кассе магазина - количество таких минимальных интервалов в течение 
рабочих часов магазина, где:
- рабочие часы магазина заданы в разделе: `[config.json, раздел: store_chain.stores.opening_hours]`
- минимальная длительность кассовой регистрации в магазинах торговой сети (одна для всех) в разделе:
`[config.json, поле:  store_chain.min_sec_per_cash_transaction]` - по умолчанию 60 сек.

### 1. Количество чеков по каждой кассе.
Для каждого магазина генерим значение дневного количества продаж (чеков) по каждой кассе.
Это произведение:
- максимального количества чеков по кассе этого магазина (см.выше)  `НА`
- рандомное число из отрезка: `[0.2, 0.7]` - коэффициента дневной нагрузки торговой сети 
`[config.json, раздел: store_chain.range_of_chain_daily_load]` `НА`
- популярность магазина (в %): `[config.json, раздел: store_chain.stores.ranks]` `НА`                
- рандомное число из отрезка: `[0.6, 1.0]` - вариативность продаж по конкретной кассе 
`[config.json, раздел: store_chain.range_of_cash_regs_daily_load]`

### 2.  Продажи по кассе.
Далее для каждой кассы генерим продажи (см. следующий раздел).

## Генератор продаж по кассе (Checkout Sales Generator):

### 1. Временные метки чеков. 
Для каждой кассы исходя из количества проведенных по ней продаж (чеков),
создаем список случайных неповторяющихся временных отметок о продаже (чеке)
в пределах заданных часов работы магазина: `[config.json, раздел: store_chain.stores.opening_hours]`

### 2. Чеки
Далее для полученных временных отметок генерим чеки (см. следующий раздел).

## Генератор чеков (Receipt Generator):
 
### 1. Одна временная отметка - один чек.
Каждая временная отметка в списке продаж по каждой кассе каждого магазина - один чек.

### 2. Количество строк чека.
Для каждого чека генерим случайное количество позиций в чеке в диапазоне 
от `1` до примерно `20` с убывающей вероятностью (экспоненциальное распределение).

### 3. Чеки.
Далее для полученного количества позиций генерим строки чека (см. следующий раздел).
  
## Генератор строк чека (Receipt String Generator):
### Состав строки чека:

### 1. `doc_id` 
Численно-буквенный идентификатор чека (длина поля - `16` символов) вида: `AaYYYYMMDDHHMMSS`, где:
- `A` - большая буква латинского алфавита по порядку, соответствующему номеру магазина: 
  - магазин № `1` - буква "`A`", 
  - № `2` - "`B`" 
  - и т.д. (не более 26 магазинов)
- `a` - маленькая буква латинского алфавита по порядку, соответствующему номеру кассы в магазине:
  - касса № `1` - буква "`a`"
  - и т.д. (не более 26 кассовых точек)
_ `YYYYMMDDHHMMSS` - полная дата/время (с секундами) без разделителей. Пример: `Ab20250319133521`
### 2. `item`
Название товара (длина поля - переменная):
- Построение: <`prefix`><`N[NNN]`>, где:
  - `prefix` - префикс имени, задается в раздел: 
    
    `[config.json, раздел: store_chain.goods.name_prefix]` и соответствует по порядку категории товара:
    `[config.json, раздел: store_chain.goods.categories]`
  - `N[NNN]` - номер товара в соответствующем диапазоне, задается в разделе:
    `[задается в config.json, раздел: store_chain.goods.category_capacity]`
  - Пример: "`дом_интерьер_100`"
 
### 3. `category`
Категория товара (бытовая химия, текстиль, посуда и т.д.). Выбирается из списка:
`[задается в config.json, раздел: store_chain.goods.categories]`

Пример: "`домашний интерьер`"

### 4. `amount`
Количество товара в чеке - рандомное число в диапазоне от `1` до примерно `20` с убывающей вероятностью 
(то же распределение, что и для количества позиций в чеке)

### 5. `price`
Цена одной позиции без учета скидки - рандомное число в диапазоне `10` до `50000` руб.
(округленное до десятков), попробуем применить `логнормальное` распределение с параметрами:
`среднее=1500`, `стандартное отклонение=1500`, `сигма= среднее/стандартное отклонение`)

### 6. `discount`
Сумма скидки на товар, для простоты будем определять как одно из:
- значений ряда: `[0.0, 0.5, 1.00, 2.50, 5.00, 10.0]`, встречающихся с соответствующими:
- вероятностями: `[0.5, 0.3, 0.10, 0.07, 0.02, 0.01]` для товаров стоимостью не менее `500` руб.

### 7. `receipt_time`
Для удобства последующей обработки добавим временную отметку о моменте совершения покупки (`время чека`).

### Ограничения:
Товар в одном чеке не должен повторяться.

### Сохранение строк чеков:
Все строки чеков сохраняются в отдельные файлы сгруппированные по каждой кассе каждого магазина.
    
## Релевантность фейковых данных (Relevance of fake data):
С целью повышения качества имитации генерируемых продажа, большего их соответствия моделируемой
предметной области, в генераторе реализовано предварительное создание всей товарной номенклатуры
торговой сети, товары которой участвуют в формировании случайных продаж (чеков)(в т.ч., установление
цены, скидок и т.д.). При этом применяется фиксированный`seed-параметр` для обеспечения повторимости 
параметров генерируемой товарной номенклатуры при каждом последующем запуске генератора.

Вместе с тем, для генерации, непосредственно, самих продаж, для каждого операционного дня применяется
свой `seed-параметр`.

Для простоты, при реализации не уделялось внимание моделированию более реалистичной структуры и 
статистики продаж в зависимости, например, от времени года, дня недели, выходных/праздничных дней
или времени дня.

## Реализация генераторов (Implementation of generators):
Для повышения скорости генерации основные процессы должны быть реализованы `асинхронно`.
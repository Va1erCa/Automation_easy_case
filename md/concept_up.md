## Концепция системы загрузки в PostgreSQL базу данных (The concept of a PostgreSQL database upload system)

## Структура и описание базы данных (Database structure and description).
([концепция имитации продуктивной базы данных](concept_db.md))

## Начальная инициализация (Initial initialization):

### 1. Настройка подключения к базе данных (Configuring the database connection).
Для корректной работы, в разделе: `[config.json, раздел: database_connection]`
должны быть указаны актуальные параметры для подключения к postgres базе данных.

        По умолчанию, указаны настройки для случая размещения базы с именем `household_goods_chain` на локальном PostgreSQL сервере.

### 2. Создание базы данных и ее начальное заполнение (Creating a database and its initial filling).
Принудительное пересоздание всех таблиц базы данных и их первоначальное заполнение производится
модулем `./sql/database_create.py`. Он должен быть запущен однократно, до запуска основных скриптов.

## Особенности реализации (Implementation features)
### 1. Трансформация (Transformation)
Для повышения реалистичности моделируемого кейса структура данных в целевой базе отличается от структуры получаемых 
"сырых" данных. Основная особенность реализованной модели - генерирование **ненормализованных** "сырых" данных, 
промежуточное их хранение и обработка средствами Pandas, дальнейшая обработка, декодирование и размещение в нормализованной
структуре PostgreSQL базы данных с применением для декодирования и трансформации данных из самой целевой базы.

### 2. Загрузка (Uploading)
Учитывая относительно небольшие обрабатываемые объемы данных все SQL операции вставки данных в таблицы целевой базы
осуществляются без разбиения на фрагменты - единым объемом. Спроектированная модель данных допускает независимую 
обработку для главных таблиц: `receipt (чеки)` и `receipt_line (строки чеков)` целевой базы, поэтому такая обработка 
реализована асинхронно.

### 3. Сводка (Summary)
Для простого контроля за пайплайном в скрипте данного этапа реализовано логирование основной статистической информации 
по данным целевой PostgreSQL базы данных. SQL-запрос для получения сводки: [summary_query.py](../sql/summary_query.py).

Пример лог-файла этапа загрузки: [up_log_2025-04-01_23-00.log](../.log/up_log_2025-04-01_23-00.log).





